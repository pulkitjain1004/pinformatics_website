<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width; initial-scale=1.0">
<title>PHPM 672 Home</title>

<!--     <link href="mobile.css" rel="stylesheet" type="text/css" media="screen and (max-width:751px)"/> -->
    <link href="large.css" rel="stylesheet" type="text/css" media="only screen and (min-width:1500px)"/>
    <link href="medium.css" rel="stylesheet" type="text/css" media="only screen and (max-width:1499px)"/>
    <link href="tablet.css" rel="stylesheet" type="text/css" media="only screen and (max-width:1167px)"/>
    <link href="mobile.css" rel="stylesheet" type="text/css" media="only screen and (max-width:650px)"/>
    <link href="print.css" rel="stylesheet" type="text/css" media="print"/>


<style type="text/css">
</style>
</head>

<body>    
	<div id="wrapper">
		<a name="ontop"> </a>
		<div class="headertop" id="headertop1">
		</div>
		<div class="headertop" id="headertop2">
			<p>
				<h1>PHPM 672 Data Science in Public Health (PhD) &</h1>
				<h1>PHPM 677 Data Science for Health Services Research (MPH)</h1>
			</p>
		</div>

		<div class="header" id="header1">
		</div>
		<div class="header" id="header2">
			<p>
				<h2>Spring 2015</h2>
				<h2>A4 Supplement</h2>
				<h3>Reshaping & Combining Tables</h3>
			</p>
		</div>
		<div class="header" id="header3">
			<h1>PHPM 677</h1>
			<h1>PHPM 672</h1>
		</div>
		<div class="header" id="header4">
			<h1>Data Science in Public Health (PhD)</h1>
			<h1>Data Science for Health Services Research (MPH)</h1>
		</div>
		<div class="header" id="header5">
		</div>
		<div class="header" id="header6">
		</div>




		<div class="top" id="top1">
		</div>
		<div class="top" id="top2">
			<ul>
		        <li><a href="index.html"> Home</a></li>
		        <li><a href="syllabus.html"> Syllabus</a></li>
		        <li><a href="A1.html"> Assignment 1 </a></li>
		        <li><a href="A2.html"> Assignment 2 </a>
		        	<ul>
		        		<li><a href="L2.html"> Lab 2 </a></li>
		        		<li><a href="L2S.html"> Lab 2 Supp. </a></li>
		        		<li><a href="A2.html"> Assignment 2 </a></li>
		        	</ul>
		        </li>
		        <li><a href="A3.html"> Assignment 3 </a>
		        	<ul>
		        		<li><a href="L3.html"> Lab 3 </a></li>
		        		<li><a href="A3.html"> Assignment 3 </a></li>
		        	</ul>
		        </li>
		        <li><a href="A4.html"> Assignment 4</a>
		        	<ul>
		        		<li><a href="data/lab4.zip" dwonload> Lab4 </a></li>
		        		<li><a href="A4.html"> Assignment 4 </a></li>
		        		<li><a href="A4A.html"> Assignment 4 Alt. </a></li>
		        		<li><a href="A4S.html"> Assignment 4 Supp. </a></li>
		        	</ul>
		        </li>
		        <li><a href="A5.html"> Assignment 5</a></li>   
		        <li><a href="Final.html"> Final Project</a></li>
		    </ul>
		</div>
		<div class="top" id="toph">
		<div class="top" id="toph">
	    	<ul>
    			<li><a href="#">M<br>E<br>N<br>U</a></li>
				<ul>
			        <li><a href="index.html"> Home</a></li>
			        <li><a href="syllabus.html"> Syllabus</a></li>
			        <li><a href="A1.html"> Assignment 1 </a></li>
			        <li><a href="A2.html"> Assignment 2 </a>
			        	<ul>
			        		<li><a href="L2.html"> Lab 2 </a></li>
			        		<li><a href="L2S.html"> Lab 2 Supp. </a></li>
			        		<li><a href="A2.html"> Assignment 2 </a></li>
			        	</ul>
			        </li>
			        <li><a href="A3.html"> Assignment 3 </a>
			        	<ul>
			        		<li><a href="L3.html"> Lab 3 </a></li>
			        		<li><a href="A3.html"> Assignment 3 </a></li>
			        	</ul>
			        </li>
			        <li><a href="A4.html"> Assignment 4</a>
			        	<ul>
			        		<li><a href="data/lab4.zip" dwonload> Lab4 </a></li>
			        		<li><a href="A4.html"> Assignment 4 </a></li>
			        		<li><a href="A4A.html"> Assignment 4 Alt. </a></li>
			        		<li><a href="A4S.html"> Assignment 4 Supp. </a></li>
			        	</ul>
			        </li>
			        <li><a href="A5.html"> Assignment 5</a></li>   
			        <li><a href="Final.html"> Final Project</a></li>
			    </ul>
			</ul>
		</div>
		</div>
		<div class="top" id="top3">
		</div>
		<div class="top" id="topside">
		</div>


		<div class="body" id="body1">
			<h2>IMPORTANT NOTE</h2>
			<p id="pbody">
				<ul>
					<li>This document supplements the full assignment 4 on the website, and is NOT a stand along document.</li>
					<li>This is optional submission for only those that have an accumulative grade less than 90% in class. The assignment is designed so that you can do this, and than do one more thing to get the full 12 points and complete the full assignment.</li>
					<li>The only difference is that you will be working with the TINY datasets so that you can see the full dataset as you build your process.  Also, I have left out the problem data rows.  You should be using proc print data=fn(obs=100) in between data steps and proc steps to see what your code does to the tables in each step.</li>
					<li>All submissions are IDENTICAL to the original assignment. I made sure that the questions are still valid in this tiny problem.  Of course, the answers will be different.</li>
					<li>You must submit sas code that answers your questions (i.e. if you manually do this without using sas code, you will not get credit)</li>
					<li>A full submission of this tiny dataset is 11 points.  1 additional point can be obtained, if you take the code you wrote, and make it run on the big dataset.  See below of hints on how to do this.</li>
				</ul>
			</p>
		</div>

		<div class="body" id="body2">
			<h2>Assignment</h2>
			<p id="phead"> &lt SAME as in the assignment 4 handout &gt</p>
			<p id="phead"> <u>Setting Up</u> </p>
			<p id="pbody">				
				Get data from BB into the appropriate folder: The links are provided only as a reference for documentation of the data. All data are provided on BB in the Assignments folder as a zipped file.  Look at the data using proc contents/proc print (use the label option) to understand what variables you have. Do NOT open these tables using point & click.  If you need more information, look at information on the webpages.
				<ol>
					<li>Texas Discharge data (<a href="http://www.dshs.state.tx.us/thcic/hospitals/Inpatientpudf.shtm" target="_blank">www.dshs.state.tx.us/thcic/hospitals/Inpatientpudf.shtm</a>)</li>
					<li>Texas Physician Supply data (<a href="http://www.dshs.state.tx.us/chs/hprc/PHYS-lnk.shtm" target="_blank">http://www.dshs.state.tx.us/chs/hprc/PHYS-lnk.shtm)</a></li>
					<li>Texas Death data (<a href="http://soupfin.tdh.state.tx.us/deathdoc.htm" target="_blank">http://soupfin.tdh.state.tx.us/deathdoc.htm</a>)</li>
					<li>Texas Health Regions Look-up Table (<a href="http://www.dshs.state.tx.us/chs/brfss/pages/counties.shtm" target="_blank">http://www.dshs.state.tx.us/chs/brfss/pages/counties.shtm</a>)</li>
				</ol>
			</P>
		</div>

		<div class="body" id="body3">
			<h2>New Text</h2>
			<p id="phead"> <u>Guideline for assignment grading (Total of 12)</u> </p>
			<p id="pbody">				
				<ul>
					<li>The initial unit of analysis for this assignment is “county year”. Thus, you will have to have 1 observation per “county year” in each table unless it is a county look up table.  The county look up table has 1 observation per county which should link to all years.
					<li>Which tables need to be changed to have 1 row per “county year”? How? Change these tables to the right unit of analysis.  Following are things to consider.<ul>
						<li>If you have multiple tables of the same kind of data (one table per year), append them as appropriate. Hint: rename variables as needed. Convert variable type to be the same if needed. Add year variable as needed during the appending process using in option.</li>
						<li>If the table is wide (years are going across columns), than convert to long (so that the years are going down rows)</li>
						<li>If you have multiple rows per “county year”, than aggregate the rows into one row using the correct statistics (sum, mean etc)</li></ul></li>
					<li>Now link all the tables together to have all the variables in one table (counts of discharge, physician supply, number of deaths, border county, etc).<ul>
						<li>What are the variables you must line up (matching vars), to get the tables to link up properly? (Hint: 1-to-1 matching and 1-to-N matching have to be done separately)</li>
						<li><b><u>There are issues with the data that make some rows not line up properly.</u></b>  Identify which rows these are and figure out how to get them to line up.  Whenever you are merging tables this way, make sure to check which rows are lining up in all tables, and which rows are not using the in option.  For the rows not lining up, check if these are expected to not line up (really missing in some tables, or not lining up due to a problems in the data).  Hint: check the county names in the tables (look up compress & lowcase functions).   There are 254 counties in TX.  The county lookup tables has the correct names.  One way to check county names in each table is to link up with the lookup table and look at rows that are not linking up properly since all should link up to one of the 254 rows in the lookup table. Once you have identify what needs to be fixed, you can use the if conditional statement to reassign to correct values.</li></ul></li>
					<li>[Read Question 7 below first] Now we will change the unit of analysis to “PHR (Public Health Region) Year”. Aggregate “county year” data to have 1 row per “PHR Year”.  Think about what is the proper statistics (sum, mean, median, etc) for the variables you need (i.e. you don’t need to have all the vars, just what you need to answer the question 7 below) when aggregating.</li>
					<li>[Read Questions 8-9 below first] Now we will change the unit of analysis to “MSA (Metropolitan Statistical Area) Border”. <ul>
						<li>First, aggregate the “county year” data to 1 row per “MSA Border Year”.  You should remove all rows that do not have the MSA designation</li>
						<li>Second, reshape the table from long (years going down the rows) to wide (years going across columns) per “MSA Border”.  You should have exactly 31 rows (number of  MSAs).</li>
						<li>Third, using arrays, calculate the percent increase in patients discharged each year (i.e. 2011 & 2012).</li></ul></li>
					</ul>
			</P>
		</div>


		<div class="footer" id="footer1">
		</div>
		<div class="footer" id="footer2">
			<p>
				PHPM Webpage <br>
				Department of Public Health
			</p>
		</div>
		<div class="footer" id="footer3">
		</div>
		<div class="footer" id="footer4">
		</div>
		<div class="footer" id="footer5">
		</div>
		<div class="footer" id="footer6">
			<p>
				Designed by <br>
				DaeYoung Yoon
			</p>
		</div>
	</div>

	<nav id="side">
			<ul>
				<li><a href="#body1">Note</a></li>
				<li><a href="#body2">Assignment</a></li>
				<li><a href="#body3">New Text</a></li>

				<li><a href="#wrapper">Top</a></li>
			</ul>
    </nav>
    <nav id="side_mobile">
    	<ul>
    		<li><a href="#">N<br>A<br>V</a></li>
			<ul>
				<li><a href="#body1">Note</a></li>
				<li><a href="#body2">Assignment</a></li>
				<li><a href="#body3">New Text</a></li>

				<li><a href="#wrapper">Top</a></li>
			</ul>
		</ul>
    </nav>
</body>
</html>
