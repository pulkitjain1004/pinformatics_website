libname data 'data';
libname raw 'raw';

proc format;
    value rhp
        48001, 48037, 48063, 48067, 48073, 48119, 48147, 48159, 48161, 48183, 
	  48203, 48213, 48223, 48225, 48231, 48277, 48315, 48343, 48365, 48379, 
	  48387, 48401, 48423, 48449 ,48455, 48459, 48467, 48499=1
        48005, 48039, 48167, 48199, 48241, 48245, 48291, 48347, 48351, 48361, 
  	  48373, 48403, 48405, 48407, 48419, 48457=2
        48015, 48057, 48071, 48089, 48157, 48201, 48321, 48473, 48481=3
        48007, 48025, 48047, 48123, 48131, 48175, 48177, 48239, 48249, 48255, 
	  48261, 48273, 48285, 48297, 48355, 48391, 48409, 48469=4
        48061, 48215, 48427, 48489=5
        48013, 48019, 48029, 48091, 48127, 48137, 48163, 48171, 48187, 48259,
	  48265, 48271, 48283, 48311, 48325, 48385, 48463, 48465, 48493, 48507=6
        48021, 48055, 48149, 48209, 48287, 48453=7
        48027, 48031, 48053, 48281, 48299, 48331, 48333, 48411, 48491=8
        48113, 48121, 48257=9
        48139, 48143, 48221, 48251, 48349, 48367, 48425, 48439, 48497=10
	48049, 48059, 48093, 48133, 48151, 48207, 48253, 48275, 48335,
	  48353, 48363, 48417, 48429, 48433, 48441=11
	48011, 48017, 48033, 48045, 48065, 48069, 48075, 48079, 48087, 48101,
	  48107, 48111, 48115, 48117, 48125, 48129, 48153, 48165, 48169, 48179,
	  48189, 48191, 48195, 48205, 48211, 48219, 48233, 48263, 48269, 48279,
	  48295, 48303, 48305, 48341, 48345, 48357, 48359, 48369, 48375, 48381,
	  48393, 48415, 48421, 48437, 48445, 48483, 48501=12
        48081, 48083, 48095, 48105, 48235, 48267, 48307, 48319, 48327, 48371,
	  48383, 48399, 48413, 48431, 48435, 48443, 48451=13		
	48003, 48043, 48103, 48109, 48135, 48173, 48227, 48243, 48301, 48317,
	  48329, 48377, 48389, 48461, 48475, 48495=14
        48141, 48229=15
	48035, 48099, 48145, 48193, 48217, 48293, 48309=16
	48041, 48051, 48185, 48289, 48313, 48339, 48395, 48471, 48477=17
	48085, 48181, 48397=18
	48009, 48023, 48077, 48097, 48155, 48197, 48237, 48337, 48447, 48485,
	  48487, 48503=19
	48247, 48323, 48479, 48505=20
        ;

%macro readxlsx(infn, sht, outfn);
  PROC IMPORT OUT= &outfn
      DATAFILE= "raw/&infn"
      DBMS=XLSX REPLACE;
      
     SHEET="&sht";    
     GETNAMES=YES;
  RUN;

  proc print data=&outfn(obs=10);
  proc contents data=&outfn;    
%mend;

%macro sas2stata(infn, outfn);
  proc export data=&infn
      file="&outfn"
      dbms=stata replace;
%mend;

%macro readcsv(infn, outfn);
  %readtxt(&infn, &outfn, CSV);
%mend;

%macro readtxt(infn, outfn, type);
  PROC IMPORT OUT= &outfn
      DATAFILE= "raw/&infn" 
      DBMS=&type REPLACE;
      
     GETNAMES=YES;
     DATAROW=2; 
  RUN;

  proc print data=&outfn(obs=10);
%mend;

